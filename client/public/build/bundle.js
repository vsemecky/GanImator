var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function o(e){e.forEach(t)}function s(e){return"function"==typeof e}function c(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function i(e,t){e.appendChild(t)}function l(e,t,n){e.insertBefore(t,n||null)}function r(e){e.parentNode.removeChild(e)}function a(e){return document.createElement(e)}function d(){return e=" ",document.createTextNode(e);var e}function u(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function f(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function g(e,t,n){e.classList[n?"add":"remove"](t)}let p;function m(e){p=e}function h(e){(function(){if(!p)throw new Error("Function called outside component initialization");return p})().$$.on_mount.push(e)}const b=[],y=[],$=[],v=[],w=Promise.resolve();let _=!1;function x(e){$.push(e)}let j=!1;const E=new Set;function k(){if(!j){j=!0;do{for(let e=0;e<b.length;e+=1){const t=b[e];m(t),S(t.$$)}for(m(null),b.length=0;y.length;)y.pop()();for(let e=0;e<$.length;e+=1){const t=$[e];E.has(t)||(E.add(t),t())}$.length=0}while(b.length);for(;v.length;)v.pop()();_=!1,j=!1,E.clear()}}function S(e){if(null!==e.fragment){e.update(),o(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(x)}}const C=new Set;function I(e,t){-1===e.$$.dirty[0]&&(b.push(e),_||(_=!0,w.then(k)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function P(c,i,l,a,d,u,f=[-1]){const g=p;m(c);const h=i.props||{},b=c.$$={fragment:null,ctx:null,props:u,update:e,not_equal:d,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(g?g.$$.context:[]),callbacks:n(),dirty:f,skip_bound:!1};let y=!1;if(b.ctx=l?l(c,h,((e,t,...n)=>{const o=n.length?n[0]:t;return b.ctx&&d(b.ctx[e],b.ctx[e]=o)&&(!b.skip_bound&&b.bound[e]&&b.bound[e](o),y&&I(c,e)),t})):[],b.update(),y=!0,o(b.before_update),b.fragment=!!a&&a(b.ctx),i.target){if(i.hydrate){const e=function(e){return Array.from(e.childNodes)}(i.target);b.fragment&&b.fragment.l(e),e.forEach(r)}else b.fragment&&b.fragment.c();i.intro&&(($=c.$$.fragment)&&$.i&&(C.delete($),$.i(v))),function(e,n,c){const{fragment:i,on_mount:l,on_destroy:r,after_update:a}=e.$$;i&&i.m(n,c),x((()=>{const n=l.map(t).filter(s);r?r.push(...n):o(n),e.$$.on_mount=[]})),a.forEach(x)}(c,i.target,i.anchor),k()}var $,v;m(g)}function T(e,t,n){const o=e.slice();return o[10]=t[n],o}function A(e){let t,n,o,c,p,m,h,b;return{c(){t=a("div"),n=a("img"),m=d(),f(n,"class","img-fluid svelte-13gbjj7"),n.src!==(o=e[10].url)&&f(n,"src",o),f(n,"title",c=e[10].seed),f(n,"alt",p=e[10].seed),g(n,"active",e[1].seed===e[10].seed),f(t,"class","thumb svelte-13gbjj7")},m(o,c){l(o,t,c),i(t,n),i(t,m),h||(b=u(n,"click",(function(){s(e[2](e[10]))&&e[2](e[10]).apply(this,arguments)})),h=!0)},p(t,s){e=t,1&s&&n.src!==(o=e[10].url)&&f(n,"src",o),1&s&&c!==(c=e[10].seed)&&f(n,"title",c),1&s&&p!==(p=e[10].seed)&&f(n,"alt",p),3&s&&g(n,"active",e[1].seed===e[10].seed)},d(e){e&&r(t),h=!1,b()}}}function O(t){let n,c,g,p,m,h,b,y,$,v,w,_,x,j,E,k,S,C,I,P,O,V,D,L=t[0],N=[];for(let e=0;e<L.length;e+=1)N[e]=A(T(t,L,e));return{c(){n=a("div"),c=a("section"),g=a("video"),p=d(),m=a("canvas"),h=d(),b=a("br"),y=d(),$=a("div"),v=a("button"),v.textContent="Delete image",w=d(),_=a("button"),_.textContent="Add tag",x=d(),j=a("aside"),E=a("div"),k=a("button"),k.textContent="+ Add random seed",S=d(),C=a("button"),C.textContent="Preload",I=d(),P=a("hr"),O=d();for(let e=0;e<N.length;e+=1)N[e].c();f(g,"id","player"),f(g,"width","384"),f(g,"height","640"),f(g,"class","svelte-13gbjj7"),f(m,"id","canvas"),f(m,"width","384"),f(m,"height","640"),f(m,"title","Canvas"),f(v,"type","button"),f(v,"class","btn btn-outline-light"),f(_,"type","button"),f(_,"class","btn btn-outline-light"),f($,"class","btn-group"),f(c,"class","col-9"),f(k,"type","button"),f(k,"class","btn btn-outline-light"),f(C,"type","button"),f(C,"class","btn btn-outline-light"),f(E,"class","btn-group"),f(j,"id","sidebar"),f(j,"class","col-3 svelte-13gbjj7"),f(n,"class","row")},m(e,o){l(e,n,o),i(n,c),i(c,g),i(c,p),i(c,m),i(c,h),i(c,b),i(c,y),i(c,$),i($,v),i($,w),i($,_),i(n,x),i(n,j),i(j,E),i(E,k),i(E,S),i(E,C),i(j,I),i(j,P),i(j,O);for(let e=0;e<N.length;e+=1)N[e].m(j,null);V||(D=[u(v,"click",(function(){s(t[4](t[1].seed))&&t[4](t[1].seed).apply(this,arguments)})),u(k,"click",t[3]),u(C,"click",t[5])],V=!0)},p(e,[n]){if(t=e,7&n){let e;for(L=t[0],e=0;e<L.length;e+=1){const o=T(t,L,e);N[e]?N[e].p(o,n):(N[e]=A(o),N[e].c(),N[e].m(j,null))}for(;e<N.length;e+=1)N[e].d(1);N.length=L.length}},i:e,o:e,d(e){e&&r(n),function(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}(N,e),V=!1,o(D)}}}function V(e,t){return"/project/video/"+e+"-"+t+".mp4"}function D(e){return new Promise((t=>setTimeout(t,e)))}function L(e,t,n){let o,s,c,i=[],l={seed:0,url:""};return h((async()=>{const e=await fetch("/api/project");let t=await e.json();console.log("Project",t),n(0,i=t.images),console.log("Images",i),n(1,l=i[0]),o=document.getElementById("player"),s=document.getElementById("canvas"),c=s.getContext("2d"),c.scale(.5,.5),o.addEventListener("play",(function(){!function e(){o.paused||o.ended||(c.drawImage(o,0,0),setTimeout(e,1e3/30))}()}),!1),o.src=V(i[1].seed,l.seed),o.autoplay=!0,o.muted=!0,o.load()})),[i,l,function(e){if(e.seed===l.seed)return!1;document.body.style.cursor="progress",console.log("seedOnClick:",e),o.src=V(l.seed,e.seed),o.load(),o.onloadeddata=function(){o.play(),document.body.style.cursor="default"},n(1,l=e),async function(e){let t;for(t of(await D(1e3),console.log("preloadSeedVideos(",e,"): START"),i)){if(e===t.seed)continue;if(e!==l.seed)return void console.log("preloadSeedVideos(",e,"): STOPPED");if(await D(100),e!==l.seed)return void console.log("preloadSeedVideos(",e,"): STOPPED");const n=await fetch(V(e,t.seed));await n.blob()}console.log("preloadSeedVideos(",e,"): FINISHED")}(l.seed)},async function(){console.log("addImageClick()");let e=prompt("Enter seed (number 1..1000):",(Math.floor(1e3*Math.random())+1).toString());if(null!=e){const t=await fetch("/api/add-image/"+e);let o=await t.json();n(0,i=o.images),console.log("addImage() RESULT",i)}},async function(e){if(console.log("removeImageClick()"),confirm("Delete image seed #"+e+" ?")){const t=await fetch("/api/remove-image/"+e);let o=await t.json();n(0,i=o.images)}},async function(){let e,t;for(e of(console.log("preloadVideos()",i),i))for(t of i){if(e.seed===t.seed)continue;console.log("preloadVideos():",e.seed,t.seed),await D(100);const n=await fetch(V(e.seed,t.seed));await n.blob()}}]}return new class extends class{$destroy(){!function(e,t){const n=e.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}{constructor(e){super(),P(this,e,L,O,c,{})}}({target:document.querySelector("#app"),props:{}})}();
//# sourceMappingURL=bundle.js.map
